
\newpage

## Предварительная калькуляция ## {#PreCalc}

### Цель:
*	Согласовать с клиентом стоимость, перечень товаров (запасных частей) и услуг (работ) на этапах: подготовка к визиту и в процессе ремонта автомобиля.

### Словарь терминов:
*	**[Заказ-Наряд]{#WorkOrder}** — Документ отгрузки [Товаров](#Product) и [Услуг](#Work)
*	**[Система]{#System}** — программа ATSP — производственная программа
*	**[Автомобиль]{#Auto}** — элемент справочника Автомобили
*	**[Владелец автомобиля]{#CarOwner}** — элемент справочника Контрагенты, Владелец автомобиля
*	**[Плательщик]{#Payer}** — Плательщик, ценообразование формируется в разрезе [Плательщик](#Payer)
*	**[Товар]{#Product}** — материальные ценности, аксессуары, запасные части, горюче-смазочные материалы.
*	**[Услуги]{#Work}** — работы, услуги по ремонту автомобиля 
*	**[Расходные материалы]{#Consumables}** — дополнительная стоимость работ за различного рода материалы, которые расходуются в процессе ремонта [Автомобиля](#Auto)
*	**[Лакокрасочные материалы]{#Paints}** — дополнительная стоимость работ
*	**[Печатная форма]{#PreCalc.PrintForm}** — печатная форма утверждённого образца
*	**[Статус]{#PreCalc.Status}** — признак состояния документа, изменяется [Пользователем](#User) или [Системой](#System) в процессе работы над документом
*	**[Номер документа]** — Признак необходимый для точной идентификации [Предварительной калькуляции](#PreCalc) формируется автоматически
*	**[Дата документа]** — фиксируется в момент создания документа
*	**[ELSA]{#ELSA}** — нормативно-справочная система для подбора списка работ и количества времени требуемого для ремонта [Автомобиля](#Auto)
*	**[AUDATEX]{#AUDATEX}** — нормативно-справочная система для подбора списка работ и количества времени требуемого для ремонта [Автомобиля](#Auto)
*	**[Цех]{#Shop}** — Идентификатор в каком цехе будет проходить ремонт
*	**[Ввод на основании]{#InsertInto}** — создание документа [Заказ-Наряд](#WorkOrder) с копированием информации из [Предварительной калькуляции](#PreCalc)
*	**[Фиксация цены]{#FixPrice}** — цена на позицию [товара](#Product) или [работы](#Work) не может быть изменена [Системой](#System) при пересчёте.
*	**[Номер направления]{#PreCalc.IncomeNumber}** — Номер страхового случая на ремонт автомобиля. Требуется для поиска [Предварительной калькуляции](#PreCalc)
*	**[Дата направления]{#PreCalc.IncomeDate}** — Дата страхового случая на ремонт автомобиля. Требуется для поиска [Предварительной калькуляции](#PreCalc)

### Жизненный цикл:
*	[Предварительная калькуляция](#PreCalc) начинается с необходимости расчёта стоимости ремонта автомобиля, и заканчивается решением [Пользователя](#User)  

### Сценарий использования:
Потребовалось рассчитать стоимость работ.

*	[Пользователь](#User) создаёт [Предварительную калькуляцию](#PreCalc)
*	[Пользователь](#User) выбирает [Цех](#Shop) в котором будет проходить ремонт
*	[Пользователь](#User) выбирает [Автомобиль](#Auto) (в случае если автомобиля нет в [Системе](#System), создаёт его)
*	[Пользователь](#User) выбирает [Владельца автомобиля](#CarOwner) (в случае если клиента нет в [Системе](#System), создаёт его)
*	[Пользователь](#User) выбирает [Плательщика](#Payer) (в случае если клиента нет в [Системе](#System), создаёт его)
*	[Пользователь](#User) заполняет [Предварительную калькуляцию](#PreCalc) [Товарами](#Product) с помощью [подбора товаров](#SelectionOfGoods) при этом:
	*	В случае отсутствия [Товара](#Product) в [Системе](#System), [Пользователь](#User) для создания [Товара](#Product) обращается к сотруднику [отдела запасных частей](#Department.Warehouse) с [ролью](#UserRole) [Старший кладовщик](#UserRole.GeneralStorekeeper) или [Менеджер склада](#UserRole.ManagerWarehouse) с просьбой о создании [Товара](#Product) в [Системе](#System) посредством Email.
	*	Стоимость формируется [Системой](#System) – автоматически.
	*	В случае необходимости [Пользователь](#User) может установить цену вручную и [зафиксировать](#FixPrice) её для конкретного [Товара](#Product).
*	[Пользователь](#User) заполняет [Предварительную калькуляцию](#PreCalc) [Товарами](#Product) с помощью [Импорт данных о товаре и количестве](#ImportData) при этом:
	*	Заполняются только те [товары](#Product) которые присутствуют в [Системе](#System) 
*	[Пользователь](#User) заполняет [Предварительную калькуляцию](#PreCalc) [Услугами](#Work), при этом: 
	*	Количество времени подбирается согласно нормативам из [ELSA](#ELSA) и [AUDATEX](#AUDATEX) и редактируется [Пользователем](#User) вручную при необходимости. 
	*	Стоимость часа работы формируется [Системой](#System) – автоматически, с возможностью ручной корректировки.
	*	[Пользователь](#User) может [зафиксировать](#FixPrice) стоимость часа работы.
*	[Пользователь](#User) указывает, в случае необходимости, сумму [Расходных материалов](#Consumables)
*	[Пользователь](#User) указывает, в случае необходимости, сумму [Лакокрасочных материалов](#Paints)
*	[Пользователь](#User) сохраняет [Предварительную калькуляцию](#PreCalc)	

При необходимости актуализации цен, [Пользователь](#User) пересчитывает цены отдельно на [товары](#Product) и/или [работы](#Work). 

При создании [Предварительной калькуляции](#PreCalc) [Статус](#PreCalc.Status) устанавливается автоматически [Системой](#System) – Открыт

*	[Пользователь](#User) формирует [Печатную Форму](#PreCalc.PrintForm) (распечатывает, или сохраняет в PDF)
*	[Пользователь](#User) отправляет [Печатную форму](#PreCalc.PrintForm) [Плательщику](#Payer)
*	[Пользователь](#User) меняет [Статус](#PreCalc.Status) — выставлен счёт

Далее, при необходимости, [Пользователь](#User) может выполнить следующие действия с [Предварительной калькуляцией](#PreCalc)

*	[Ввод на основании](#InsertInto) [Заказ-Наряд](#WorkOrder) с копированием
	*	Позиций	[товаров](#Product), их количеством и (ценами если они [зафиксированы](#FixPrice))
	*	Позиций [услуг](#Work), их количеством и (ценами если они [зафиксированы](#FixPrice))
	
В случае, если с [Плательщик](#Payer) не договорились [Пользователь](#User) меняет [Статус](#PreCalc.Status) — Закрыт
	
### Требования:	
[Предварительная калькуляция](#PreCalc) должен содержать следующие реквизиты

*	[Номер]{#PreCalc.Number}
*	[Дата]{#PreCalc.Date}
*	[Клиент](#CarOwner)
*	[Автомобиль](#Auto)
*	[Плательщик](#Payer)
*	[Пользователь](#User)
*	[Цех](#Shop) 
	*	Кузовной
	*	Общего ремонта
	*	Дополнительного оборудования
*	Внутренний комментарий
*	Внешний комментарий	
*	[Статус]
	*	[Открыт] — устанавливается [Системой](#System) при создании [Предварительной калькуляции](#PreCalc)
	*	[Выставлен счёт] — выбирается [Пользователем](#User)  после отправки [Печатной формы](#PreCalc.PrintForm) [Плательщик](#Payer)
	*	[Заказ товара] 
	*	[Согласование] 
	*	[Закрыт] — устанавливается [Пользователем](#User) – вручную
*	[Номер направления](#PreCalc.IncomeNumber)
*	[Дата направления](#PreCalc.IncomeDate)
*	Номер [Заказ-Наряд](#WorkOrder) — связывает [Предварительную калькуляцию](#PreCalc) и созданный [Заказ-Наряд](#WorkOrder) 

[Предварительная калькуляция](#PreCalc) должна включать в себя

*	Список [Услуг](#Work) с количеством требуемого времени и стоимостью часа работы.
*	Список [Товаров](#Product) с требуемым количеством и стоимостью.
*	Стоимость [Расходные материалы](#Consumables).
*	Стоимость [Лакокрасочных материалов](#Paints).

[Предварительная калькуляция](#PreCalc) должна реализовывать следующие возможности

*	Возможность формирования [Печатную Форму](#PreCalc.PrintForm).
*	Возможность ограничить отображение кода товара в [Печатной форме](#PreCalc.PrintForm)
*	Добавление, редактирование, удаление позиций [Товаров](#Product) ограничение прав доступа.
*	Добавление, редактирование, удаление позиций [Услуг](#Work).
*	Добавление, редактирование, удаление стоимости [Расходных материалов](#Consumables).
*	Добавление, редактирование, удаление стоимости [Лакокрасочных материалов](#Paints).
*	Копирование списка [Товаров](#Product) из любого [заказ наряда](#WorkOrder) в [предварительную калькуляцию](#PreCalc).
*	Копирование списка [Услуг](#Work) из любого [заказ наряда](#WorkOrder) в [предварительную калькуляцию](#PreCalc).
*	Возможность обновления цен из справочника Номенклатуры по требованию [Пользователя](#User).
*	Цены [Услуги](#Work) и [Товары](#Product) должны быть рассчитываемые через механизм договорных условий в разрезе [плательщика](#Payer).
*	Ввод на основании [Предварительной калькуляции](#PreCalc) документа [Заказ-Наряд](#WorkOrder). С дальнейшей возможностью заказа запчастей в рамках [Заказ-Наряда](#WorkOrder)
*	Возможность формирования печатной формы "заявка на склад для заказа запасных частей".
*	Возможность фиксации цен на каждую [работу](#Work) или [товар](#Product). 
*	Возможность пересчёта цен отдельно на [товары](#Product) и/или [работы](#Work).
*	Возможность увидеть дату и время последнего пересчёта цен отдельно на [товары](#Product) и/или [работы](#Work).
*	При смене [плательщика](#Payer) требуется автоматически пересчитывать цены на [товары](#Product) и [работы](#Work) в разрезе  [плательщика](#Payer) с учётом [договорных условий](#СontractualСondition)
*	Возможность заполнения списка [товаров](#Product) с помощью [подбора товаров](#SelectionOfGoods)
*	Возможность заполнения списка [товаров](#Product) с помощью [Импорт данных о товаре и количестве](#ImportData)
*	Возможность формирования печатной формы "наличие товара на складах на всех площадках". 

Журнал [Предварительной калькуляции](#PreCalc) должен реализовать следующие возможности

*	Поиск по следующим параметрам
	*	[Номер документа]
	*	[Дата документа]
	*	[Владелец автомобиля](#CarOwner)
	*	[Плательщик](#Payer)
	*	[Цех]
	*	[Номер направления](#PreCalc.IncomeNumber)
	*	[Дата направления](#PreCalc.IncomeDate)
	*	VIN
	*	Государственный регистрационный знак.
	